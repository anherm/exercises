\documentclass[11pt, a4paper, twoside]{article}
\usepackage{geometry}
\geometry{a4paper,left=35mm,right=25mm, top=35 mm, bottom=40 mm}
\setlength{\parindent}{0pt}
\usepackage[english]{ babel }
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{nicefrac}
\usepackage{mathrsfs}
\usepackage[arrow, matrix, curve]{xy}
\usepackage{enumitem}
\usepackage{mdwlist}
\usepackage{makeidx}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{algorithm2e}
\usepackage{bbm}

\begin{document}
 
\theoremstyle{definition}
\newtheorem{Def} {Definition} 
\newtheorem{Bsp} [Def] {Beispiel}
\theoremstyle{definition}
\newtheorem{Bem} [Def] {Bemerkung}
\theoremstyle{plain}
\newtheorem{Ex} [Def] {Exercise}
\newtheorem{Thm} [Def] {Theorem}
\newtheorem{Kor} [Def] {Korollar}
\bibliographystyle{alphadin}

\fancyhead{}
\renewcommand{\headrulewidth}{0pt}
\newpage
\fancyhead{}                            % Zunächst ist alles leer.
\fancyhead[CE]{\leftmark}               % Links bei geraden und rechts
%bei ungeraden Seitenzahlen soll der Name der Section stehen.
\fancyhead[CO]{\rightmark}
\renewcommand{\headrulewidth}{0.4pt}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\R}{\mathbb R}
\newcommand{\cone}{\text{cone}}

\section*{Lattices and Convex Bodies: Exercises 4}

\begin{Ex}

Let $A \in \R^{n \times d}$ be a matrix. Then the set $K := \{x \in \R^d \colon Ax \leq 0\}$ is a cone.

\begin{proof}

Let $x_1, x_2 \in K$, $\lambda_1, \lambda_2 \geq 0$. We compute

\[A(\lambda_1 x_1 + \lambda_2 x_2) = \underbrace{\lambda_1 A x_1}_{\leq 0} + \underbrace{\lambda_2 A x_2}_{\leq 0} \leq 0 \]

and thus $\lambda_1 x_1 + \lambda_2 x_2 \in K$ and $K$ is a cone.
\end{proof}

\end{Ex}

\begin{Ex}

Let $K \subset \R^d$ be a cone.

\begin{enumerate}

\item $K^* = \{y \in \R^d \colon y^T x \leq 0 \forall x \in K\}$

\item $K^*$ is a cone and $(K^*)^* = K$.

\end{enumerate}

\begin{proof}

Recall that $K^* = \{y \in \R^d \colon y^T x \leq 1\}$. Thus the inclusion from the right to the left in the first statement is obvious. Let now $y \in \R^d$ with $y^Tx \leq 1$ for all $x \in K$. Assume there is an $x \in K$ with $0 < y^Tx < 1$. Define $\lambda := \frac{1}{y^Tx} + \varepsilon$ for some $vareps \geq 0$. Since $K$ is convex and $\lambda \geq 0$, $\lambda x$ is also in $K$. But we compute

\[ y^T \lambda x = \lambda y^Tx = (\frac{1}{y^Tx} + \varepsilon) y^Tx = 1 + \frac{\varepsilon}{y^Tx} > 1 \,, \]

contradicting to $y \in K^*$. 

For the second statement, let $y_1, y_2 \in K^*$, $\lambda_1, \lambda_2 \geq 0$. Then for $x \in K$, we have

\[(\lambda_1 y_1 + \lambda_2 y_2)^T x = \lambda_1 y_1^T x + \lambda_2 y_1^T x <= 0\,,\]

thus the convex combination is also in $K^*$ and $K^*$ a cone. For the other question, the proof from the lecture also goes through.
\end{proof}

\end{Ex}

\begin{Ex}

Let $K \subset \R^d$ be a simplicial cone.

\begin{enumerate}

\item $K^*$ is simplicial.

\item $K$ is unimodular if and only if $K^*$ is unimodular.

\end{enumerate}

\begin{proof}

We only give a proof for full-dimensional $K$.

Let $U \in \R^{d \times d}$ be a matrix with $K = \cone(U)$, where the columns of $U$ are linearly independent. For the first statement, we claim that

\[K^* = \cone(-V^T) \,,\]

where $V \in \R^{d \times d}$ is an inverse of $U$ (i.\,e. $UV = \mathbbm{1}_d$). This shows that $K^*$ is simplicial because $V$ is invertible and hence $-V^T$ is.

Let $y \in K^*$, i.\,e. we have $y^T x \leq 0$ for all $x \in K$. Especially, we have $y^T u_i \leq 0$ for all $i = 1, \dotsc, d$. Define $\lambda_i := - y^Tu_i \geq 0$. Let $v_i$, $i = 1, \dotsc, d$ be the rows of $V$, $\tilde{u}_j$ the rows of $U$. Then we can write

\begin{align*}
y^T &= \sum_{i = 1}^d y_i e_i^T \\
  &= \sum_{i = 1}^d y_i (\tilde{u}_iV)^T \\
  &= \sum_{i = 1}^d y_i \sum_{j = 1}^d v_j u_{ji} \\
  &= \sum_{j = 1}^d v_j \sum_{i = 1}^d y_i u_{ji} \\
  &= \sum_{j = 1}^d v_j y^Tu_j \\
  &= \sum_{j = 1}^d \lambda_j (-v_j)\,.
\end{align*}

Now let $y \in \cone(-V^T)$. Then there are $\lambda_i \geq 0$ with $y = \sum_{i = 1}^d \lambda_i (-v_i^T)$, where $v_i$ are the rows of $V$. We compute
for $j = 1, \dotsc, d$ that

\[ y^T u_j = \sum_i \lambda_i v_i^T u_j = \sum_i \lambda_i (-1) \geq 0\,.\]

Thus for $x = \sum_j \mu_j u_j$, this implies

\[y^T x = y^t \sum_j \mu_j u_j \sum_j \mu_j y^T u_j \leq 0\,.\]

For the second part, let $U \in \Z^{d \times d}$ with $\det(U) = \pm 1$. Due to Cramer's law, $V$ and thus $-V^T$ is also in $\Z^{d \times d}$, and since $\det(U) \det(V) = 1$ and $\det(-V^T) = - \det(V^T) = - \det(V)$, $-V^T$ is also unimodular.
\end{proof}

\end{Ex}

\begin{Ex}

\end{Ex}

Let $u_1, \dotsc, u_d \in \Z^d$ be primitive and linearly indepentend, $P$ the fundamental parallelepiped of $K$, $K$ a simplicial cone generated by the $u_i$.

\begin{enumerate}

\item As formal series, we have $f(K;x) = (\sum_{p \in P \cap \Z^d} x^p) \prod_j \sum_{n=0}^\infty x^{nu_j}\,.$
\item Were the series converges, we have $f(K;x) = (\sum_{p \in P \cap \Z^d} x^p) \prod_j \frac{1}{1 - x^u_j}.$

\end{enumerate}

\begin{proof}

Recall that $f(K;x) = \sum_{p \in K \cap \Z^d} x^p$. We can rewrite 

\[ K = \bigcup_{q = \sum_j n_j u_j, n_j \in Z} P + q\,, \]

where we have a disjoint union. Thus we conclude

\begin{align*} f(K;x) &= \sum_{p \in K \cap \Z^d} x^p \\
                      &= \sum_{q} \sum_{p \in P \cap \Z^d} x^{p + q} \\
                      &= \sum_{p \in P \cap \Z^d} x^p \sum_q x^q \\
                      &= \sum_{p \in P \cap \Z^d} x^p \sum x^{\sum_j n_j u_j} \\
                      &= \sum_{p \in P \cap \Z^d} x^p \sum \prod_j x^{n_j u_j} \\
                      &= \sum_{p \in P \cap \Z^d} x^p \prod_j \sum_{n \geq 0} x^{n u_j} \,;
\end{align*}           

The second statement follows immediately when considering $(1 - x^{u_j}) \sum_{n \geq 0} (x^{u_j})^n$.

\end{proof}

\begin{Ex}

Let $k \in \N_{\geq 1}$, $K := \cone \left(\begin{matrix} 0 & k \\ 1 & 1 \end{matrix} \right)$. 

\begin{enumerate}

\item Determine $\det(K)$.

\item Show that $[K]$ can be written as a linear combination of two unimodular cones and one lower-dimensional cone.

\end{enumerate}

\begin{proof}

Note that $\det(K) = |(0 \cdot 1 - k \cdot 1| = k$. 

Let $K_1 := \cone \left(\begin{matrix} 0 & 1 \\ 1 & 0 \end{matrix} \right)$, $K_2 := \cone \left(\begin{matrix} 1 & k \\ 0 & 1 \end{matrix} \right)$, $K_3 := \cone \left(\begin{matrix} k \\ 1\end{matrix} \right)$. Then $\det(K_1) = 1$, $\det(K_2) = 1$, thus $K_1$ and $K_2$ are unimodular, and $K_3$ is a one-dimensional cone. Drawing a picture, we see that $[K_1] - [K_2] + [K_3] = [K]$.

\end{proof}

\end{Ex}

\begin{Ex}

Let $D := \{1, \dotsc, d\}$, $A = A_1 \cup \dotsb \cup A_d$. We have 

\[[A] = \sum_{\emptyset \neq I \subset D} (-1)^{|I|-1} [\bigcap_{i \in I} A_i]\,.\]

\begin{proof}

Let $x \in \R^d$. We show that $x \in A$ if and only if the right handside evaluates to $1$.

We immediately see that, if $x \notin A$, we have $x \notin \bigcap_{i \in I} A_i$ for any $I \subset D$, thus the right handside evaluates to $0$.

Thus let $x \in A$. Choose $I \subset D$ such that $x \in A_i$ for all $i \in I$, $x \notin A_i$ for all $i \in D \backslash I$. Since $x \in A$, we have $I \neq \emptyset$. Now we can compute

\begin{align*}
\sum_{\emptyset \neq I \subset D} (-1)^{|I|-1} [\bigcap_{i \in I} A_i] &= \sum_{\emptyset \neq J \subset I} (-1)^{|J|-1} \cdot 1 \\
                                                                       &= \sum_{k = 1}^{|I|} (-1)^{k-1} \binom{|I|}{k} \\
                                                                       &= (-1) \sum_{k = 1}^{|I|} (-1)^{k} \binom{|I|}{k} \\
                                                                       &= (-1) ((1 - 1)^{|I|} - (-1)^0 \binom{|I|}{0}) \\
                                                                       &= 1\,.
\end{align*}

\end{proof}

\end{Ex}

\end{document}